<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‚µãƒ­ãƒ³äºˆç´„ãƒ•ã‚©ãƒ¼ãƒ </title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">
    <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
    <style>
        /* --- ã‚«ãƒ©ãƒ¼ãƒ‘ãƒ¬ãƒƒãƒˆè¨­å®š --- */
        :root {
            --brand-color: #95c0ec; /* æŒ‡å®šã‚«ãƒ©ãƒ¼ï¼šã‚¹ã‚«ã‚¤ãƒ–ãƒ«ãƒ¼ */
            --primary-text: #ffffff; /* ãƒ–ãƒ©ãƒ³ãƒ‰ã‚«ãƒ©ãƒ¼ä¸Šã®ãƒ†ã‚­ã‚¹ãƒˆ */
            --accent-color: #7aaedc;  /* æ¿ƒã„ã‚ã®åŒç³»è‰²ï¼ˆå¼·èª¿ç”¨ï¼‰ */
            --bg-color: #f4f8fc;      /* èƒŒæ™¯è‰²ï¼šéå¸¸ã«è–„ã„é’ã‚°ãƒ¬ãƒ¼ */
            --text-color: #333333;    /* é€šå¸¸ãƒ†ã‚­ã‚¹ãƒˆ */
            --white: #ffffff;
            --gray-border: #ddd;
        }

        body {
            font-family: 'Noto Sans JP', sans-serif;
            background-color: var(--bg-color);
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            margin: 0;
            padding-top: 10px;
            padding-bottom: 40px;
            color: var(--text-color);
            overflow-x: hidden;
        }

        .container {
            background-color: var(--white);
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(149, 192, 236, 0.3);
            width: 96%;
            max-width: 500px;
            padding: 25px;
            box-sizing: border-box;
            margin: 0 auto;
            border-top: 5px solid var(--brand-color);
        }

        h1 {
            background: var(--brand-color);
            color: var(--primary-text);
            padding: 20px 15px;
            text-align: center;
            margin: -25px -25px 30px -25px;
            font-size: 20px;
            font-weight: 700;
            letter-spacing: 1px;
            border-radius: 8px 8px 0 0;
            text-shadow: 0 1px 2px rgba(0,0,0,0.1);
        }

        /* ãƒ©ãƒ™ãƒ«å…±é€šã‚¹ã‚¿ã‚¤ãƒ« */
        .label, .labelkibounitizi, .labeltyuuou, .labelmessezi {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
            padding: 5px 0;
            font-weight: 700;
            color: #555;
            font-size: 15px;
            border-left: 5px solid var(--brand-color);
            padding-left: 10px;
        }
        
        /* å¿…é ˆãƒãƒ¼ã‚¯ */
        .required {
            font-size: 11px;
            margin-left: auto;
            background-color: #ff6b6b; /* å¿…é ˆã¯ç›®ç«‹ã¤èµ¤ç³» */
            color: var(--white);
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: normal;
        }

        input[type="text"],
        input[type="tel"],
        textarea {
            width: 100%;
            padding: 12px;
            margin-bottom: 20px;
            border: 1px solid var(--gray-border);
            border-radius: 4px;
            box-sizing: border-box;
            font-size: 16px;
            background-color: #fafafa;
            transition: all 0.3s;
        }

        input:focus,
        textarea:focus {
            border-color: var(--brand-color);
            background-color: var(--white);
            outline: none;
            box-shadow: 0 0 0 2px rgba(149, 192, 236, 0.3);
        }

        /* ãƒœã‚¿ãƒ³ã‚¨ãƒªã‚¢ */
        .selection-group {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 25px;
        }

        /* é¸æŠãƒœã‚¿ãƒ³ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .selection-btn {
            flex: 1 1 45%;
            padding: 12px 5px;
            border: 1px solid var(--gray-border);
            border-radius: 4px;
            background-color: var(--white);
            color: var(--text-color);
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s;
            text-align: center;
        }

        .selection-btn:hover {
            border-color: var(--brand-color);
            background-color: #f0f7ff;
        }

        /* é¸æŠæ™‚ã‚¹ã‚¿ã‚¤ãƒ« */
        .selection-btn.active {
            background-color: var(--brand-color);
            color: var(--white);
            border-color: var(--brand-color);
            font-weight: bold;
            box-shadow: 0 2px 6px rgba(149, 192, 236, 0.4);
        }

        /* å¤§ãƒ¡ãƒ‹ãƒ¥ãƒ¼ç”¨ï¼ˆå°‘ã—å¤§ããï¼‰ */
        .main-menu-btn {
            padding: 15px 10px;
            font-size: 16px;
        }

        /* è©³ç´°èª¬æ˜ã‚¨ãƒªã‚¢ */
        #detail-area {
            background-color: #f8fbfd;
            border: 1px dashed var(--brand-color);
            border-radius: 6px;
            padding: 15px;
            margin-bottom: 20px;
            display: none; /* åˆæœŸã¯éè¡¨ç¤º */
        }
        
        #detail-area h3 {
            margin: 0 0 10px 0;
            font-size: 16px;
            color: #4a7090; /* æ¿ƒã„ãƒ–ãƒ«ãƒ¼ */
        }

        #detail-area p {
            margin: 0 0 8px 0;
            font-size: 13px;
            line-height: 1.6;
            color: #555;
            white-space: pre-wrap; /* æ”¹è¡Œã‚’åæ˜  */
        }

        #detail-area .price {
            font-weight: bold;
            color: #e65100;
            font-size: 15px;
            margin-top: 10px;
            border-top: 1px solid #ddd;
            padding-top: 8px;
            display: block;
        }

        /* æ—¥æ™‚é¸æŠå‘¨ã‚Š */
        .datetime-wrapper {
            position: relative;
            margin-bottom: 20px;
        }
        
        .placeholder {
            display: block;
            font-size: 13px;
            color: #888;
            margin-bottom: 5px;
        }

        .dt-grid {
            display: flex;
            gap: 10px;
        }

        .datetime-input {
            flex: 1;
            padding: 12px;
            font-size: 15px;
            border: 1px solid var(--gray-border);
            border-radius: 4px;
            background-color: var(--white);
            cursor: pointer;
            /* iOSãªã©ã§è§’ä¸¸ãƒªã‚»ãƒƒãƒˆ */
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none; 
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%2395c0ec' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 10px center;
            background-size: 16px;
        }

        /* ç¢ºèªç”»é¢ã‚¨ãƒªã‚¢ */
        #displayInfo {
            font-size: 14px;
            border: 1px solid #eee;
            padding: 15px;
            background: #fcfcfc;
            margin-bottom: 20px;
            border-radius: 4px;
        }

        .info-row {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            padding: 10px 0;
            border-bottom: 1px dashed #ddd;
        }
        
        .info-row:last-child {
            border-bottom: none;
        }

        .info-label {
            font-weight: bold;
            color: var(--accent-color);
            font-size: 12px;
            display: block;
            margin-bottom: 4px;
        }

        .edit-button {
            background-color: transparent;
            color: var(--accent-color);
            border: 1px solid var(--accent-color);
            border-radius: 4px;
            padding: 2px 8px;
            font-size: 11px;
            cursor: pointer;
            margin-left: 10px;
            white-space: nowrap;
        }

        /* äºˆç´„ãƒœã‚¿ãƒ³ */
        .submit-button {
            width: 100%;
            padding: 16px;
            font-size: 18px;
            font-weight: bold;
            background-color: var(--brand-color);
            color: var(--white);
            border: none;
            border-radius: 6px;
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(149, 192, 236, 0.4);
            transition: transform 0.1s, box-shadow 0.3s;
        }

        .submit-button:active {
            transform: translateY(2px);
            box-shadow: none;
        }

        @media (max-width: 600px) {
            .container {
                width: 100%;
                padding: 20px 15px;
                border-radius: 0;
                box-shadow: none;
                border-top: none;
            }
            h1 {
                margin: -20px -15px 25px -15px;
                border-radius: 0;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>ã”äºˆç´„ãƒ•ã‚©ãƒ¼ãƒ </h1>

        <div class="label" id="lbl-name">ãŠåå‰<span class="required">å¿…é ˆ</span></div>
        <input type="text" id="name" placeholder="ä¾‹ï¼‰å±±ç”° å¤ªéƒ" oninput="updateDisplayInfo()">

        <div class="label" id="lbl-phone">é›»è©±ç•ªå·<span class="required">å¿…é ˆ</span></div>
        <input type="tel" id="phone" placeholder="ä¾‹ï¼‰090-1234-5678" oninput="updateDisplayInfo()">

        <div class="label" id="lbl-visit">æ¥åº—å›æ•°<span class="required">å¿…é ˆ</span></div>
        <div class="selection-group">
            <button type="button" class="selection-btn" onclick="selectVisit('1å›ç›®', this)">1å›ç›®</button>
            <button type="button" class="selection-btn" onclick="selectVisit('2å›ç›®ä»¥é™', this)">2å›ç›®ä»¥é™</button>
        </div>

        <div class="label" id="lbl-category">ã”å¸Œæœ›ã‚«ãƒ†ã‚´ãƒªãƒ¼<span class="required">å¿…é ˆ</span></div>
        <div class="selection-group">
            <button type="button" class="selection-btn main-menu-btn" onclick="selectCategory('chiro', this)">ğŸŸ¥ ã‚«ã‚¤ãƒ­ãƒ—ãƒ©ã‚¯ãƒ†ã‚£ãƒƒã‚¯</button>
            <button type="button" class="selection-btn main-menu-btn" onclick="selectCategory('esthe', this)">ğŸŸ¥ ã‚¨ã‚¹ãƒ†</button>
        </div>

        <div id="sub-menu-container" style="display:none;">
            <div class="label" id="lbl-menu">è©³ç´°ãƒ¡ãƒ‹ãƒ¥ãƒ¼é¸æŠ<span class="required">å¿…é ˆ</span></div>
            <div class="selection-group" id="sub-menu-buttons">
                </div>
        </div>

        <div id="detail-area">
            <h3 id="detail-title"></h3>
            <p id="detail-desc"></p>
            <span id="detail-price" class="price"></span>
        </div>

        <div class="labelkibounitizi" id="kibou1">ç¬¬ä¸€å¸Œæœ›æ—¥æ™‚<span class="required">å¿…é ˆ</span></div>
        <div class="datetime-wrapper">
            <span class="placeholder" id="placeholder1">â–¼ æ—¥æ™‚ã‚’é¸æŠ</span>
            <input type="hidden" id="date1">
            <div class="dt-grid">
                <select id="date1_day" class="datetime-input" onchange="updateDateTime('date1')"></select>
                <select id="date1_time" class="datetime-input" onchange="updateDateTime('date1')"></select>
            </div>
        </div>

        <div class="labelkibounitizi" id="kibou2">ç¬¬äºŒå¸Œæœ›æ—¥æ™‚<span class="required">å¿…é ˆ</span></div>
        <div class="datetime-wrapper">
            <span class="placeholder" id="placeholder2">â–¼ æ—¥æ™‚ã‚’é¸æŠ</span>
            <input type="hidden" id="date2">
            <div class="dt-grid">
                <select id="date2_day" class="datetime-input" onchange="updateDateTime('date2')"></select>
                <select id="date2_time" class="datetime-input" onchange="updateDateTime('date2')"></select>
            </div>
        </div>

        <div class="labelmessezi">ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ»ã”è³ªå•</div>
        <textarea id="message" rows="4" placeholder="ã”è¦æœ›ãªã©ãŒã”ã–ã„ã¾ã—ãŸã‚‰ã”è¨˜å…¥ãã ã•ã„"></textarea>

        <div class="labeltyuuou">ã”äºˆç´„å†…å®¹ã®ç¢ºèª</div>
        <div id="displayInfo">
            <p style="text-align:center; color:#ccc; font-size:12px; margin:0;">å…¥åŠ›å†…å®¹ãŒã“ã“ã«åæ˜ ã•ã‚Œã¾ã™</p>
        </div>

        <button class="submit-button" onclick="submitForm()">äºˆç´„ã‚’ç¢ºå®šã™ã‚‹</button>
    </div>

    <script src="https://static.line-scdn.net/liff/edge/2.1/sdk.js"></script>
    <script>
        // --- ãƒ‡ãƒ¼ã‚¿å®šç¾© ---
        const MENU_DATA = {
            'chiro': {
                label: 'ã‚«ã‚¤ãƒ­ãƒ—ãƒ©ã‚¯ãƒ†ã‚£ãƒƒã‚¯',
                items: [
                    {
                        id: 'ak_chiro',
                        name: 'â‘ AK ã‚«ã‚¤ãƒ­ãƒ—ãƒ©ã‚¯ãƒ†ã‚£ãƒƒã‚¯',
                        desc: 'ç¥çµŒã®çŠ¶æ…‹ã‚’è‰¯ãã™ã‚‹ãŸã‚ã€ç­‹è‚‰ã¨éª¨ã®ä¸¡æ–¹ã‹ã‚‰ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã™ã‚‹ã®ãŒç‰¹å¾´ã§ã™',
                        price: 'åˆè¨ºï¼š5,000å†† / å†æ¥ï¼š4,000å††'
                    },
                    {
                        id: 'sato_lymph',
                        name: 'â‘¡ä½è—¤å¼ ãƒªãƒ³ãƒ‘ã‚±ã‚¢',
                        desc: 'â€»ãƒ¢ãƒ‹ã‚¿ãƒ¼æ§˜ã¯ãŠå†™çœŸã‚’ãŠæ’®ã‚Šã•ã›ã¦ã„ãŸã ãã¾ã™ğŸ™‡â€â™€ï¸',
                        price: 'é€šå¸¸ï¼š10,000å†† / ãƒ¢ãƒ‹ã‚¿ãƒ¼ï¼š5,000å††'
                    },
                    {
                        id: 'chiro_lymph',
                        name: 'â‘¢ã‚«ã‚¤ãƒ­ãƒªãƒ³ãƒ‘ã‚±ã‚¢ã‚³ãƒ¼ã‚¹',
                        desc: 'AKã‚«ã‚¤ãƒ­Ã—ä½è—¤å¼ãƒªãƒ³ãƒ‘ã®ã‚»ãƒƒãƒˆã‚³ãƒ¼ã‚¹\nã‚«ã‚¤ãƒ­ãƒ»ãƒªãƒ³ãƒ‘ã‚’åŒæ™‚ã«ã•ã‚ŒãŸã„æ–¹ã«',
                        price: 'é€šå¸¸ï¼š13,000å†† / ãƒ¢ãƒ‹ã‚¿ãƒ¼ï¼š8,000å††'
                    }
                ]
            },
            'esthe': {
                label: 'ã‚¨ã‚¹ãƒ†',
                items: [
                    {
                        id: 'ex',
                        name: 'â‘ ã‚¨ã‚¯ã‚¹ãƒ›ãƒªã‚¨ãƒ¼ã‚·ãƒ§ãƒ³(EX)',
                        desc: 'ãŠé¡”ã®å¤ã„è§’è³ªã€è§’å±¤ã®ã‚±ã‚¢ãŒã§ã\næœ€å¾Œã«ã‚ªã‚¤ãƒ«ãƒˆãƒªãƒ¼ãƒˆãƒ¡ãƒ³ãƒˆã§æ•´ãˆã¾ã™',
                        price: 'æ–™é‡‘ï¼š5,500å††'
                    },
                    {
                        id: 'oil',
                        name: 'â‘¡ã‚ªã‚¤ãƒ«ãƒˆãƒªãƒ¼ãƒˆãƒ¡ãƒ³ãƒˆ',
                        desc: 'ãŠè‚Œã«åˆã£ãŸã‚ªã‚¤ãƒ«ã§å„ªã—ããŠè‚Œã®ã‚±ã‚¢\nä¿æ¹¿ã¨æ¯›ç©´ã®ã‚±ã‚¢ãŒã§ãã¾ã™',
                        price: 'æ–™é‡‘ï¼š2,200å††',
                        condition: 'repeat_only' // 2å›ç›®ä»¥é™ã®ã¿è¡¨ç¤º
                    },
                    {
                        id: 'herb',
                        name: 'â‘¢ãƒãƒ¼ãƒ–è’¸ã—',
                        desc: 'å›æ•°åˆ¸è³¼å…¥ã§ãŠå¾—ã«å—ã‘ã‚‰ã‚Œã¾ã™',
                        price: 'ä½“é¨“ãƒã‚±ãƒƒãƒˆï¼š4,400å††\næ–™é‡‘ï¼š1å›ã€œ7,700å††'
                    },
                    {
                        id: 'hydrogen',
                        name: 'â‘£æ°´ç´ å¸å¼•',
                        desc: 'ç–²åŠ´è»½æ¸›ã‚„ç¾è‚Œã«åŠ¹æœã®ã‚ã‚‹æ°´ç´ å¸å¼•\nç´°èƒã‚’æ´»æ€§åŒ–ã•ã›ã‚‹ã‚¢ãƒ³ãƒã‚¨ã‚¤ã‚¸ãƒ³ã‚°ã«ã‚ªã‚¹ã‚¹ãƒ¡ã§ã™',
                        price: 'ä½“é¨“ãƒã‚±ãƒƒãƒˆï¼š2,200å††\næ–™é‡‘ï¼š3,300å††'
                    }
                ]
            }
        };

        // --- çŠ¶æ…‹ç®¡ç† ---
        let state = {
            name: '',
            phone: '',
            visitCount: '',      // "1å›ç›®" or "2å›ç›®ä»¥é™"
            category: '',        // "chiro" or "esthe"
            selectedMenuId: '',  // é¸æŠã•ã‚ŒãŸè©³ç´°ãƒ¡ãƒ‹ãƒ¥ãƒ¼ID
            selectedMenuName: '',
            date1: '',
            date2: ''
        };

        // --- LIFFåˆæœŸåŒ– (æ—¢å­˜ç¶­æŒ) ---
        document.addEventListener('DOMContentLoaded', function () {
            // æ—¥ä»˜é¸æŠè‚¢ã®ç”Ÿæˆ
            initDatePickers();

            liff.init({
                liffId: 'YOUR_LIFF_ID_HERE' // â˜…ã”è‡ªèº«ã®LIFF IDã‚’è¨­å®šã—ã¦ãã ã•ã„
            }).then(() => {
                console.log('LIFF init success');
            }).catch((err) => {
                console.log('LIFF init failed', err);
            });
        });

        // --- æ¥åº—å›æ•°é¸æŠ ---
        function selectVisit(val, btn) {
            // ãƒœã‚¿ãƒ³ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ–åˆ‡ã‚Šæ›¿ãˆ
            const parent = btn.parentElement;
            Array.from(parent.children).forEach(c => c.classList.remove('active'));
            btn.classList.add('active');

            state.visitCount = val;

            // ã‚«ãƒ†ã‚´ãƒªãƒ¼ãŒæ—¢ã«é¸æŠã•ã‚Œã¦ã„ã‚‹å ´åˆã€ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’å†æç”»ï¼ˆã‚ªã‚¤ãƒ«ãƒˆãƒªãƒ¼ãƒˆãƒ¡ãƒ³ãƒˆã®è¡¨ç¤ºåˆ¶å¾¡ã®ãŸã‚ï¼‰
            if (state.category) {
                renderSubMenus(state.category);
            }
            updateDisplayInfo();
        }

        // --- ã‚«ãƒ†ã‚´ãƒªãƒ¼é¸æŠ ---
        function selectCategory(catKey, btn) {
            const parent = btn.parentElement;
            Array.from(parent.children).forEach(c => c.classList.remove('active'));
            btn.classList.add('active');

            state.category = catKey;
            
            // ã‚«ãƒ†ã‚´ãƒªãƒ¼å¤‰æ›´æ™‚ã¯è©³ç´°é¸æŠã‚’ãƒªã‚»ãƒƒãƒˆ
            state.selectedMenuId = '';
            state.selectedMenuName = '';
            document.getElementById('detail-area').style.display = 'none';

            renderSubMenus(catKey);
            updateDisplayInfo();
        }

        // --- è©³ç´°ãƒ¡ãƒ‹ãƒ¥ãƒ¼æç”» ---
        function renderSubMenus(catKey) {
            const container = document.getElementById('sub-menu-container');
            const btnGroup = document.getElementById('sub-menu-buttons');
            
            container.style.display = 'block';
            btnGroup.innerHTML = ''; // ã‚¯ãƒªã‚¢

            const items = MENU_DATA[catKey].items;

            items.forEach(item => {
                // è¡¨ç¤ºæ¡ä»¶ãƒã‚§ãƒƒã‚¯ï¼ˆã‚ªã‚¤ãƒ«ãƒˆãƒªãƒ¼ãƒˆãƒ¡ãƒ³ãƒˆç”¨ï¼‰
                if (item.condition === 'repeat_only') {
                    // ã€Œ2å›ç›®ä»¥é™ã€ãŒé¸æŠã•ã‚Œã¦ã„ãªã„å ´åˆã¯ã‚¹ã‚­ãƒƒãƒ—
                    if (state.visitCount !== '2å›ç›®ä»¥é™') {
                        return; 
                    }
                }

                const btn = document.createElement('button');
                btn.type = 'button';
                btn.className = 'selection-btn';
                btn.textContent = item.name;
                
                // å†æç”»æ™‚ã«é¸æŠçŠ¶æ…‹ã‚’ç¶­æŒã™ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
                if (state.selectedMenuId === item.id) {
                    btn.classList.add('active');
                }

                btn.onclick = function() {
                    selectSubMenu(item, this);
                };
                
                btnGroup.appendChild(btn);
            });
        }

        // --- è©³ç´°ãƒ¡ãƒ‹ãƒ¥ãƒ¼é¸æŠæ™‚ã®å‡¦ç† ---
        function selectSubMenu(item, btn) {
            const parent = btn.parentElement;
            Array.from(parent.children).forEach(c => c.classList.remove('active'));
            btn.classList.add('active');

            state.selectedMenuId = item.id;
            state.selectedMenuName = item.name;

            // è©³ç´°ã‚¨ãƒªã‚¢è¡¨ç¤º
            const area = document.getElementById('detail-area');
            const title = document.getElementById('detail-title');
            const desc = document.getElementById('detail-desc');
            const price = document.getElementById('detail-price');

            area.style.display = 'block';
            title.textContent = item.name;
            desc.textContent = item.desc;
            price.textContent = item.price;

            updateDisplayInfo();
        }

        // --- æ—¥æ™‚é¸æŠé–¢é€£ ---
        function initDatePickers() {
            const ids = ['date1', 'date2'];
            const jpWd = ['æ—¥', 'æœˆ', 'ç«', 'æ°´', 'æœ¨', 'é‡‘', 'åœŸ'];
            
            ids.forEach(id => {
                const daySel = document.getElementById(id + '_day');
                const timeSel = document.getElementById(id + '_time');

                // æ—¥ä»˜ (60æ—¥åˆ†)
                let d = new Date();
                daySel.innerHTML = '<option value="" disabled selected>æ—¥ä»˜</option>';
                for(let i=0; i<60; i++){
                    const y = d.getFullYear();
                    const m = String(d.getMonth()+1).padStart(2, '0');
                    const day = String(d.getDate()).padStart(2, '0');
                    const wd = jpWd[d.getDay()];
                    
                    const val = `${y}-${m}-${day}`;
                    const txt = `${m}/${day} (${wd})`;
                    
                    const opt = document.createElement('option');
                    opt.value = val;
                    opt.textContent = txt;
                    daySel.appendChild(opt);
                    
                    d.setDate(d.getDate()+1);
                }

                // æ™‚é–“ (10:00 - 20:00)
                timeSel.innerHTML = '<option value="" disabled selected>æ™‚é–“</option>';
                for(let h=10; h<=20; h++){
                    const vals = (h===20) ? [0] : [0, 30]; // 20:30ã¯é™¤å¤–
                    vals.forEach(m => {
                        const timeStr = `${String(h).padStart(2,'0')}:${String(m).padStart(2,'0')}`;
                        const opt = document.createElement('option');
                        opt.value = timeStr;
                        opt.textContent = timeStr;
                        timeSel.appendChild(opt);
                    });
                }
            });
        }

        function updateDateTime(id) {
            const day = document.getElementById(id + '_day').value;
            const time = document.getElementById(id + '_time').value;
            const hidden = document.getElementById(id);
            const ph = document.getElementById('placeholder' + id.slice(-1));

            if(day && time) {
                hidden.value = `${day} ${time}`;
                ph.style.display = 'none';
            } else {
                hidden.value = '';
                ph.style.display = 'block';
                ph.textContent = day ? 'â–¼ æ™‚é–“ã‚’é¸æŠ' : 'â–¼ æ—¥æ™‚ã‚’é¸æŠ';
            }
            updateDisplayInfo();
        }

        // --- ç¢ºèªè¡¨ç¤ºã®æ›´æ–° ---
        function updateDisplayInfo() {
            state.name = document.getElementById('name').value;
            state.phone = document.getElementById('phone').value;
            const d1 = document.getElementById('date1').value || 'æœªé¸æŠ';
            const d2 = document.getElementById('date2').value || 'æœªé¸æŠ';

            let html = '';
            
            // Helper
            const row = (lbl, val, targetId) => `
                <div class="info-row">
                    <div style="flex:1;">
                        <span class="info-label">ã€${lbl}ã€‘</span>
                        <span>${val || 'æœªå…¥åŠ›'}</span>
                    </div>
                    <button class="edit-button" onclick="scrollToId('${targetId}')">ä¿®æ­£</button>
                </div>`;

            html += row('ãŠåå‰', state.name, 'lbl-name');
            html += row('é›»è©±ç•ªå·', state.phone, 'lbl-phone');
            html += row('æ¥åº—å›æ•°', state.visitCount, 'lbl-visit');
            html += row('ã”å¸Œæœ›ãƒ¡ãƒ‹ãƒ¥ãƒ¼', state.selectedMenuName, 'lbl-category');
            html += row('ç¬¬ä¸€å¸Œæœ›', d1, 'kibou1');
            html += row('ç¬¬äºŒå¸Œæœ›', d2, 'kibou2');

            document.getElementById('displayInfo').innerHTML = html;
        }

        function scrollToId(id) {
            const el = document.getElementById(id);
            if(el) el.scrollIntoView({behavior: 'smooth', block: 'center'});
        }

        // --- é€ä¿¡å‡¦ç†ï¼ˆãƒ‡ãƒ¢ï¼‰ ---
        function submitForm() {
            if(!state.name || !state.phone || !state.visitCount || !state.selectedMenuName || !document.getElementById('date1').value) {
                alert('å¿…é ˆé …ç›®ï¼ˆâ€»ï¼‰ã‚’ã™ã¹ã¦å…¥åŠ›ã—ã¦ãã ã•ã„');
                return;
            }

            const msg = `ã€äºˆç´„ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡ã€‘\n\n`
                + `åå‰: ${state.name}\n`
                + `é›»è©±: ${state.phone}\n`
                + `å›æ•°: ${state.visitCount}\n`
                + `ãƒ¡ãƒ‹ãƒ¥ãƒ¼: ${state.selectedMenuName}\n`
                + `ç¬¬ä¸€å¸Œæœ›: ${document.getElementById('date1').value}\n`
                + `ç¬¬äºŒå¸Œæœ›: ${document.getElementById('date2').value}\n`
                + `è©³ç´°: ${document.getElementById('message').value}`;

            // å®Ÿéš›ã®é‹ç”¨ã§ã¯ã“ã“ã§LIFF.sendMessagesãªã©ã‚’è¡Œã„ã¾ã™
            alert(msg);
            // liff.sendMessages([{ type: 'text', text: msg }]).then(() => liff.closeWindow());
        }

    </script>
</body>
</html>